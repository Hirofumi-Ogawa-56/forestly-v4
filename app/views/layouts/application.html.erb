<!-- app/views/layouts/application.html.erb -->
<!DOCTYPE html>
<html class="h-full bg-gray-50">
  <head>
    <title><%= content_for(:title) || "Forestly V4" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_include_tag "application", "data-turbo-track": "reload", type: "module" %>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  </head>

  <%# bodyをh-fullかつoverflow-hiddenにすることで、ブラウザ全体のスクロールを止めます %>
  <body class="h-full overflow-hidden text-gray-900">
    <% if user_signed_in? %>
      <div class="h-full flex flex-col">
        <%# 1. ヘッダーセクション（固定） %>
        <header class="flex-shrink-0 z-40">
          <%= render 'layouts/header' %>
        </header>

        <%# 2. 下部セクション（サイドバーとメイン） %>
        <div class="flex flex-1 overflow-hidden">
          
          <%# サイドバー（独立してスクロール） %>
          <aside class="w-64 bg-white border-r border-gray-200 hidden md:flex flex-col flex-shrink-0">
            <nav class="flex-1 overflow-y-auto px-4 py-6 space-y-1 custom-scrollbar">
              <%= yield :sidebar if content_for?(:sidebar) %>
            </nav>
          </aside>

          <%# メインコンテンツ（独立してスクロール） %>
          <main class="flex-1 overflow-y-auto bg-white focus:outline-none custom-scrollbar">
            <div class="py-6 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto">
              <%= yield %>
            </div>
          </main>

        </div>
      </div>
    <% else %>
      <%# ログイン前は通常のスクロール %>
      <div class="min-h-full overflow-y-auto">
        <%= yield %>
      </div>
    <% end %>

    <style>
      /* スクロールバーの見た目を少し細くしてモダンにする（任意） */
      .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
      }
      .custom-scrollbar::-webkit-scrollbar-track {
        background: transparent;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb {
        background: #e5e7eb;
        border-radius: 10px;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: #d1d5db;
      }
    </style>
  </body>
</html>
